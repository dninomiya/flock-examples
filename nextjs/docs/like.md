## 仕組み

いいねを行う場合以下の処理が発生します。

1. **該当記事のFirestoreドキュメント** に属する **likesサブコレクション** に **いいねしたユーザーのID** を格納
2. `1` と同時に **該当記事のFirestoreドキュメント** の `likeCount` を `+1` する

いいねを外す場合、上記とは逆の処理が発生します。

1. **該当記事のFirestoreドキュメント** に属する **likesサブコレクション** から **いいねしたユーザーのID** を削除
2. `1` と同時に **該当記事のFirestoreドキュメント** の `likeCount` を `-1` する

## ポイント

- アプリケーションの利用中無駄な再リクエストを発生させないために [SWR](https://swr.vercel.app/ja) を使用しています。
- いいねの切り替えを即時に反映させるために [ミューテーション](https://swr.vercel.app/ja/docs/mutation) を使っています。
- **記事ドキュメントのいいね数更新** と **likesサブコレクションへの追加（削除）** をワンセットで行うために [トランザクション](https://firebase.google.com/docs/firestore/manage-data/transactions?hl=ja) を使用しています。
- [use-debounce](https://www.npmjs.com/package/use-debounce) を使って高速連打を一回のクリックとして処理しています。

## 使い方

1. サンプルコードベースに **いいねボタンコンポーネント** を作成する。
2. 記事一覧ページや記事詳細ページで使用します。（サンプルコードではダミーのユーザーIDや記事IDを初期値として使用しています）